## Escritura de ficheros

Para escribir datos en un fichero, lo abrimos en el modo "w" de escritura.

```python
import os
f = open("myfile.txt", "wt", encoding="utf8")
f.write("Hello world!")
f.close()
print(os.listdir()) # comprobamos que se ha creado el fichero
```

El método __write('contenido')__  añadirá __'contenido'__ al fichero y nos devolverá el número de caracteres que se han escrito.

El contenido que se escribe es literalmente el que nosotros pasamos explícitamente al método **write**, con lo que si queremos que se añada **un final de línea tendríamos que añadirlo manualmente**, añadiendo el caracter de fin de línea '\n' a nuestra cadena.

```python
import os
f = open("myfile.txt", "wt")
f.write("Hello\nworld!\n") # Aparecerá en 2 líneas
f.close()
```

Si queremos escribir los valores de una variable tendremos que convertirlo a una cadena para que se guarden. Por ejemplo:

```python
import os
f = open("datos.csv", "wt")
dia = 25
mes = 12
temperatura = 17.5
strDatos = f'{dia},{mes},{temperatura}'
f.write(strDatos)
f.close()
```

Si queremos escribir una lista, podemos pasarla directamente usando el método writelines, pero este lo guardará concatenando los elementos, sin añadirle separación, con lo que o se lo añadimos a los elementos o lo hacemos iterando la lista con un bucle for y añadiendo el carácter fin de línea en cada escritura

```python
lista = ['Hola', 'Mundo', '2024']
f = open('fichero_lista.txt','wt', encoding="utf8")
f.write('# Usando writelines\n')
f.writelines(lista) # aparecerá una línea con todos los elementos
f.write('\n') # separando un formato de otro
f.write('# Usando write línea a línea\n')
for elemento in lista:
    f.write(elemento+'\n')
f.close()
```

En el caso de que el fichero ya existiera usando el modo "w" éste se sobrescribe, borrando el anterior fichero. También podemos añadir al contenido al final del fichero usando el modo "a".

## Errores

El manejo de fichero puede llevar aparejado errores, muchas veces no por nuestro código si no por circunstancias externas.

Si no podemos escribir por tema de permisos se producirá una excepción del tipo *PermissionError*. Si no podemos escribir o por otra razón (no exista el directorio, el disco está lleno,...) se producirá otra excepción. 

Todas estas excepciones se conocen como "Excepciones en tiempo de ejecución" (Runtime Exceptions) y por ellas es conveniente incluir las operaciones con ficheros dentro de bloques try/except 

```python
import os
try:
   f = open("myfile.txt", "wt")
   f.write("Hello world!")
   f.close()
   print(os.listdir()) # comprobamos que se ha creado el fichero
except Exception as e: # Se mostrarán detalles del error
   print('Error:',e)
```

## Abreviando código al trabajar con ficheros

Como es algo muy frecuente abrir ficheros, leer o escribirlos y cerrarlos, hay una forma abreviada para hacerlo, usando la palabra reservada **with** seguida de un bloque de código, terminado el cuál se liberarán los recursos usados, cerrando los ficheros abiertos:

```python
with open("myfile.txt", "w") as f:
   f.write("Hello\n world!")

print(os.listdir())

with open("myfile.txt", "r") as f:
   print(f.readlines())
```

