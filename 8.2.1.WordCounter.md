## Ejemplo: Contador de caracteres, palabras y líneas de ficheros: WordCounter

Vamos a hacer un sencillo ejemplo que va a leer el contenido de un fichero y contar las líneas, las palabras y los caracteres que tiene

[Código v0.1](https://raw.githubusercontent.com/javacasm/CursoPython/master/codigo/8.2.1.WordCounter_v0.1.py)

```python
# Fichero quijote.txt de https://gist.github.com/jsdario/6d6c69398cb0c73111e49f1218960f79

nombre_fichero = './el_quijote.txt'

file = open(nombre_fichero, 'rt', encoding="utf8") # Abrimos el fichero en modo lectura de texto y con codificación Utf-8

numero_lineas = 0
numero_palabras = 0
numero_caracteres = 0

for lineaRaw in file: # va a recuperar línea a línea el contenido del fichero
    linea = lineaRaw.strip('\n') # no contaremos el fin de línea como caracter 

    palabras = linea.split() # Lista de palabras de la línea que hemos leído
    numero_lineas += 1
    numero_palabras += len(palabras) 
    numero_caracteres += len(linea)

file.close()

print(f'"{nombre_fichero}" {numero_lineas} {numero_palabras} {numero_caracteres}')
    
```


Un error típico es cuando no se encuentra el fichero. Por ejemplo si obtenemos este error:

```sh
javacasm@bitL5:~/Dropbox/Cursos/CursoPython/codigo$ python3 8.2.1.WordCounter_v0.1.py 
Traceback (most recent call last):
  File "8.2.1.WordCounter_v0.1.py", line 5, in <module>
    file = open(nombre_fichero, 'rt') # Abrimos el fichero en modo lectura de texto
FileNotFoundError: [Errno 2] No such file or directory: 'codigo/data/el_quijote.txt'
```

Nos dice que está buscando el fichero de texto en "codigo/data/el_quijote.txt". Tenemos 2 alternativas:

* Cambiamos el código para que lo busque en el directorio exacto donde hemos puesto el fichero o 
* Ponemos el fichero de texto en ese directorio concreto.

### Ejemplo: Contador de palabras de 1 directorio v0.2

Ahora vamos a utilizar el programa anterior para contar las líneas, palabras y  caracteres a todos los ficheros de un directorio. Para ello solo tenemos que iterar sobre la colección de ficheros que nos devuelve el *os.listdir()* e ir sumando los resultados de cada uno.


[Código v0.2](https://raw.githubusercontent.com/javacasm/CursoPython/master/codigo/8.2.1.WordCounter_v0.2.py)

```python
import os 

def fileWordCounter(nombre_fichero):
    file = open(nombre_fichero, "rt", encoding="utf8")

    numero_lineas = 0
    numero_palabras = 0
    numero_caracteres = 0
    
    for lineaRaw in file:
        linea = lineaRaw.strip('\n') # no contaremos el fin de línea como caracter 

        palabras = linea.split() # Lista de palabras
        numero_lineas += 1
        numero_palabras += len(palabras)
        numero_caracteres += len(linea)

    file.close()

    return numero_lineas, numero_palabras, numero_caracteres


ficheros = os.listdir() 
print('Fichero;líneas;palabras;caracteres;')
for fichero in ficheros:
    try:
        if fichero.endswith('.py'):
            nLineas,nPalabras,nCaracteres = fileWordCounter(fichero)
            print('"{}";{};{};{};'.format(fichero,nLineas,nPalabras,nCaracteres ))
    except:
        pass
        # print('Error con ',fichero)

    
```


[![Vídeo:  Contador de caracteres, palabras y líneas de ficheros ](https://img.youtube.com/vi/oYSdCI3WSy4/0.jpg)](https://drive.google.com/file/d/1P_L6m7pS6D_HiLpnDnq7KqdTdfSH1Neh/view?usp=sharing)

[Vídeo:  Contador de caracteres, palabras y líneas de ficheros](https://drive.google.com/file/d/1P_L6m7pS6D_HiLpnDnq7KqdTdfSH1Neh/view?usp=sharing)

Podemos mejorar el ejemplo haciendo que se detecte si es un fichero o directorio con *os.path.isfile(f)* y sólo en el caso en que sea un fichero haga el recuento. 

```python
import os
for f in os.listdir():
    if os.path.isfile(f): 
        print(f'"{f}" es fichero')
    else : 
        print(f'"{f}" es un directorio')
```

